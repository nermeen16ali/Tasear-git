const STEP = 3;

function toggleProducts() {
    const container = document.querySelector('.productsRow');
    if (!container) return;

    const items = Array.from(container.querySelectorAll('.product-item'));
    const btn = document.getElementById('toggleBtn');

    if (!items.length || !btn) return;

    const hiddenItems = items.filter(item => item.classList.contains('d-none'));
    const visibleItems = items.filter(item => !item.classList.contains('d-none'));

    // SHOW MORE - reveal 3 hidden products
    if (hiddenItems.length > 0) {
        hiddenItems.slice(0, STEP).forEach(item => {
            item.classList.remove('d-none');
        });

        // Update button text when all products are visible
        const stillHidden = items.filter(item => item.classList.contains('d-none'));
        if (stillHidden.length === 0) {
            btn.innerHTML = `عرض أقل
                <svg xmlns="http://www.w3.org/2000/svg" width="9" height="9" viewBox="0 0 9 9" fill="none">
                    <path d="M0.476827 0.500675C0.324423 0.66502 0.23989 0.881863 0.18671 1.06647C0.129979 1.2634 0.0912988 1.48866 0.0642131 1.72062C0.00993169 2.18547 -0.00363442 2.73057 0.000772857 3.24075C0.00520505 3.75381 0.0279992 4.24526 0.0495641 4.60749C0.0603651 4.78892 0.0709022 4.93865 0.0787669 5.04336C0.0827004 5.09574 0.0859687 5.13689 0.0882719 5.16515L0.0909664 5.1977L0.0917013 5.20634L0.0919906 5.2097C0.115956 5.4848 0.358397 5.68838 0.633497 5.66442C0.908584 5.64045 1.11213 5.39765 1.08819 5.12257L1.08804 5.12089L1.08743 5.11362L1.08497 5.08395C1.08283 5.05765 1.07972 5.0186 1.07596 4.96847C1.06842 4.86817 1.05825 4.72364 1.0478 4.54806C1.02685 4.1963 1.00497 3.72281 1.00074 3.23211C0.996471 2.73853 1.01024 2.24104 1.05746 1.8366C1.06012 1.81389 1.06286 1.79164 1.06568 1.76985L8.14905 8.85322C8.34431 9.04848 8.6609 9.04848 8.85616 8.85322C9.05142 8.65796 9.05142 8.34138 8.85616 8.14612L1.77115 1.0611C1.78071 1.05993 1.79038 1.05877 1.80014 1.05762C2.20002 1.01076 2.70031 0.996765 3.2003 1.00061C3.69717 1.00442 4.1797 1.02568 4.53903 1.04611C4.71838 1.0563 4.86631 1.06625 4.96909 1.07362C5.02047 1.0773 5.06052 1.08034 5.08753 1.08244L5.11804 1.08485L5.1277 1.08564C5.40287 1.10849 5.64449 0.903955 5.66736 0.628774C5.69024 0.35358 5.48537 0.111919 5.21017 0.0890433L5.20712 0.0887915L5.19831 0.0880769L5.16507 0.0854505C5.13619 0.0832043 5.09413 0.0800158 5.04062 0.0761782C4.93364 0.0685056 4.78074 0.0582307 4.59578 0.0477174C4.22651 0.0267271 3.72657 0.00461966 3.20799 0.000635205C2.69253 -0.00332509 2.14439 0.0104397 1.68375 0.0644202C1.45424 0.0913157 1.23125 0.12986 1.03851 0.18708C0.862872 0.239226 0.637286 0.327644 0.476827 0.500675Z" fill="#374151"></path>
                </svg>`;
        }
    }
    // SHOW LESS - hide products back to initial state (keep only first 3 visible)
    else {
        items.forEach((item, index) => {
            if (index >= STEP) {
                item.classList.add('d-none');
            }
        });

        btn.innerHTML = `عرض المزيد
            <svg xmlns="http://www.w3.org/2000/svg" width="9" height="9" viewBox="0 0 9 9" fill="none">
                <path d="M0.476827 0.500675C0.324423 0.66502 0.23989 0.881863 0.18671 1.06647C0.129979 1.2634 0.0912988 1.48866 0.0642131 1.72062C0.00993169 2.18547 -0.00363442 2.73057 0.000772857 3.24075C0.00520505 3.75381 0.0279992 4.24526 0.0495641 4.60749C0.0603651 4.78892 0.0709022 4.93865 0.0787669 5.04336C0.0827004 5.09574 0.0859687 5.13689 0.0882719 5.16515L0.0909664 5.1977L0.0917013 5.20634L0.0919906 5.2097C0.115956 5.4848 0.358397 5.68838 0.633497 5.66442C0.908584 5.64045 1.11213 5.39765 1.08819 5.12257L1.08804 5.12089L1.08743 5.11362L1.08497 5.08395C1.08283 5.05765 1.07972 5.0186 1.07596 4.96847C1.06842 4.86817 1.05825 4.72364 1.0478 4.54806C1.02685 4.1963 1.00497 3.72281 1.00074 3.23211C0.996471 2.73853 1.01024 2.24104 1.05746 1.8366C1.06012 1.81389 1.06286 1.79164 1.06568 1.76985L8.14905 8.85322C8.34431 9.04848 8.6609 9.04848 8.85616 8.85322C9.05142 8.65796 9.05142 8.34138 8.85616 8.14612L1.77115 1.0611C1.78071 1.05993 1.79038 1.05877 1.80014 1.05762C2.20002 1.01076 2.70031 0.996765 3.2003 1.00061C3.69717 1.00442 4.1797 1.02568 4.53903 1.04611C4.71838 1.0563 4.86631 1.06625 4.96909 1.07362C5.02047 1.0773 5.06052 1.08034 5.08753 1.08244L5.11804 1.08485L5.1277 1.08564C5.40287 1.10849 5.64449 0.903955 5.66736 0.628774C5.69024 0.35358 5.48537 0.111919 5.21017 0.0890433L5.20712 0.0887915L5.19831 0.0880769L5.16507 0.0854505C5.13619 0.0832043 5.09413 0.0800158 5.04062 0.0761782C4.93364 0.0685056 4.78074 0.0582307 4.59578 0.0477174C4.22651 0.0267271 3.72657 0.00461966 3.20799 0.000635205C2.69253 -0.00332509 2.14439 0.0104397 1.68375 0.0644202C1.45424 0.0913157 1.23125 0.12986 1.03851 0.18708C0.862872 0.239226 0.637286 0.327644 0.476827 0.500675Z" fill="#374151"></path>
            </svg>`;

        // Scroll back to top of products
        container.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
}
